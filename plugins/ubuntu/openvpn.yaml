# OpenVPN TLS Scanner Plugin
# CBOM Generator v1.3 - Plugin Schema v1.0

plugin:
  plugin_schema_version: "1.0"
  name: "OpenVPN TLS Scanner"
  version: "1.0.0"
  author: "CipherIQ Team"
  category: "vpn"
  description: "Detects OpenVPN instances and extracts TLS/SSL configuration"
  priority: 50
  requires_cbom_version: "1.3.0"

detection:
  methods:
    # Method 1: Detect by binary executable (Phase 1: False Positive Elimination)
    - type: binary
      paths:
        - "/usr/sbin/openvpn"
        - "/usr/local/sbin/openvpn"
      required: true
      confidence: 0.95

    # Method 2: Detect by process name
    - type: process
      names:
        - "openvpn"
      command_patterns:
        - ".*\\.conf.*"
        - ".*--config.*"

    # Method 3: Detect by port
      ports: [1194, 443]
      protocol: "udp"
      check_ssl: false

    - type: config_file
      paths:
        - "/etc/openvpn/server.conf"
        - "/etc/openvpn/client.conf"
      required: false

# config_extraction removed - config files typically don't exist unless configured
